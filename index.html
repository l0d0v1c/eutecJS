<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur d'Eutectiques n-aires</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lexend Deca', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0f172a;
            min-height: 100vh;
            color: #cbd5e1;
            font-weight: 400;
            letter-spacing: -0.025em;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 32px 20px;
        }

        h1 {
            text-align: center;
            color: #f1f5f9;
            margin-bottom: 12px;
            font-size: 3.2rem;
            font-weight: 700;
            letter-spacing: -0.05em;
            animation: fadeInDown 1s ease-out;
        }

        .subtitle {
            text-align: center;
            color: #94a3b8;
            margin-bottom: 40px;
            font-size: 1.25rem;
            font-weight: 300;
            letter-spacing: 0.025em;
            animation: fadeInUp 1s ease-out 0.3s both;
        }

        .main-panel {
            background: rgba(30, 41, 59, 0.4);
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(71, 85, 105, 0.2);
            animation: slideInUp 0.8s ease-out 0.6s both;
            color: #cbd5e1;
        }

        .controls-section {
            display: flex;
            gap: 40px;
            margin-bottom: 40px;
        }

        .material-selector {
            flex: 2;
            background: rgba(15, 23, 42, 0.6);
            padding: 28px;
            border-radius: 12px;
            border: 1px solid rgba(71, 85, 105, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .material-selector:hover {
            border-color: rgba(71, 85, 105, 0.5);
            transform: translateY(-1px);
        }

        .material-selector h3 {
            color: #f1f5f9;
            margin-bottom: 24px;
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: -0.025em;
        }

        .dropdown-container {
            background: rgba(30, 41, 59, 0.4);
            margin: 16px 0;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(71, 85, 105, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            animation: slideInRight 0.5s ease-out;
        }

        .dropdown-container:hover {
            border-color: rgba(71, 85, 105, 0.4);
            transform: translateY(-1px);
        }

        .dropdown-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .dropdown-header label {
            font-weight: 600;
            color: #e2e8f0;
            font-size: 1.1rem;
        }

        .material-select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 6px;
            font-size: 1rem;
            font-family: 'Lexend Deca', sans-serif;
            font-weight: 400;
            background: rgba(15, 23, 42, 0.8);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            color: #cbd5e1;
        }

        .material-select:focus {
            outline: none;
            border-color: #64748b;
            background: rgba(15, 23, 42, 1);
        }

        .material-select option {
            padding: 10px;
        }

        .material-info {
            margin-top: 16px;
            padding: 12px;
            background: rgba(51, 65, 85, 0.4);
            border-radius: 6px;
            font-size: 0.9rem;
            color: #94a3b8;
            display: none;
            animation: fadeIn 0.3s ease;
            border: 1px solid rgba(71, 85, 105, 0.2);
        }

        .material-info.show {
            display: block;
        }

        .remove-btn {
            background: #475569;
            color: #f1f5f9;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            font-family: 'Lexend Deca', sans-serif;
            transition: all 0.3s ease;
        }

        .remove-btn:hover {
            background: #334155;
            transform: translateY(-1px);
        }

        .add-material-btn {
            background: #475569;
            color: #f1f5f9;
            border: none;
            padding: 14px 20px;
            font-size: 1rem;
            font-weight: 500;
            font-family: 'Lexend Deca', sans-serif;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .add-material-btn:hover {
            background: #334155;
            transform: translateY(-1px);
        }

        .test-cases {
            margin-top: 24px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(113, 128, 150, 0.2);
            box-shadow: 0 2px 10px rgba(0,0,0,0.06);
        }

        .test-cases h4 {
            color: #2d3748;
            margin-bottom: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
        }

        .test-case-btn {
            background: #334155;
            color: #f1f5f9;
            border: 1px solid rgba(71, 85, 105, 0.3);
            padding: 12px 16px;
            font-size: 0.95rem;
            font-weight: 500;
            font-family: 'Lexend Deca', sans-serif;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 10px;
        }

        .test-case-btn:hover {
            background: #475569;
            border-color: #64748b;
        }

        .test-case-btn:last-child {
            margin-bottom: 0;
        }

        .genetic-algorithm {
            margin-top: 24px;
            background: rgba(30, 41, 59, 0.4);
            border-radius: 8px;
            padding: 20px;
            border: 1px solid rgba(71, 85, 105, 0.3);
        }

        .genetic-algorithm h4 {
            color: #cbd5e1;
            margin-bottom: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
        }

        .genetic-controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .control-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .control-group label {
            font-size: 0.9rem;
            font-weight: 500;
            color: #cbd5e1;
        }

        .genetic-input, .genetic-select {
            padding: 8px 12px;
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 6px;
            font-family: 'Lexend Deca', sans-serif;
            background: #1e293b;
            color: #f1f5f9;
            font-size: 0.9rem;
            width: 120px;
        }

        .genetic-input:focus, .genetic-select:focus {
            outline: none;
            border-color: #64748b;
            background: #334155;
        }

        .genetic-btn {
            background: #334155;
            color: #f1f5f9;
            border: 1px solid rgba(71, 85, 105, 0.3);
            padding: 14px 20px;
            font-size: 1rem;
            font-weight: 600;
            font-family: 'Lexend Deca', sans-serif;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            margin-bottom: 16px;
        }

        .genetic-btn:hover {
            background: #475569;
            border-color: #64748b;
        }

        .genetic-btn:disabled {
            background: #1e293b;
            color: #64748b;
            cursor: not-allowed;
            border-color: rgba(71, 85, 105, 0.2);
        }

        .genetic-progress {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 16px;
            display: none;
        }

        .genetic-progress.active {
            display: block;
        }

        .progress-bar {
            height: 8px;
            background: rgba(128, 90, 213, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-bar::before {
            content: '';
            display: block;
            height: 100%;
            background: #475569;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-text {
            font-size: 0.85rem;
            color: #cbd5e1;
            text-align: center;
            font-weight: 500;
        }

        .genetic-results {
            display: none;
            background: rgba(30, 41, 59, 0.4);
            border-radius: 8px;
            padding: 16px;
            border: 1px solid rgba(71, 85, 105, 0.3);
        }

        .genetic-results.show {
            display: block;
            animation: slideInUp 0.5s ease-out;
        }

        .solution-item {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #805ad5;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .solution-item:hover {
            background: rgba(128, 90, 213, 0.05);
            transform: translateX(5px);
        }

        .solution-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .solution-title {
            font-weight: 600;
            color: #cbd5e1;
            font-size: 0.95rem;
        }

        .solution-temp {
            background: #475569;
            color: #f1f5f9;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .solution-components {
            font-size: 0.85rem;
            color: #6b46c1;
            line-height: 1.4;
        }

        .calculation-panel {
            flex: 1;
            background: rgba(15, 23, 42, 0.6);
            padding: 28px;
            border-radius: 12px;
            border: 1px solid rgba(71, 85, 105, 0.3);
        }

        .calculation-panel h3 {
            color: #f1f5f9;
            margin-bottom: 24px;
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        .calculate-btn {
            background: #1e293b;
            color: #f1f5f9;
            border: 1px solid rgba(71, 85, 105, 0.3);
            padding: 16px 32px;
            font-size: 1.1rem;
            font-weight: 500;
            font-family: 'Lexend Deca', sans-serif;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 16px;
            letter-spacing: -0.025em;
        }

        .calculate-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transition: all 0.6s ease;
            transform: translate(-50%, -50%);
        }

        .calculate-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .calculate-btn:hover {
            background: #0f172a;
            border-color: rgba(71, 85, 105, 0.5);
            transform: translateY(-1px);
        }

        .calculate-btn:disabled {
            background: #374151;
            color: #6b7280;
            cursor: not-allowed;
            transform: none;
            border-color: rgba(55, 65, 81, 0.3);
        }

        .reset-btn {
            background: #64748b;
            color: #f1f5f9;
            border: none;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 500;
            font-family: 'Lexend Deca', sans-serif;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 16px;
        }

        .reset-btn:hover {
            background: #475569;
            transform: translateY(-1px);
        }

        .results {
            background: rgba(255, 255, 255, 0.95);
            padding: 24px;
            border-radius: 16px;
            border-left: 4px solid #4299e1;
            margin-top: 24px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            backdrop-filter: blur(10px);
        }

        .results.show {
            opacity: 1;
            transform: translateY(0);
        }

        .composition-diagram {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            padding: 32px;
            margin-top: 32px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.12);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .composition-diagram h3 {
            color: #2d3748;
            margin-bottom: 24px;
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: -0.025em;
            text-align: center;
        }

        .pie-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            width: 100%;
        }

        .pie-chart {
            max-width: 400px;
            max-height: 400px;
            width: 100%;
            height: auto;
            filter: drop-shadow(0 8px 20px rgba(0,0,0,0.15));
        }
        
        @media (max-width: 768px) {
            .pie-chart {
                max-width: 300px;
                max-height: 300px;
            }
        }
        
        @media (max-width: 480px) {
            .pie-chart {
                max-width: 250px;
                max-height: 250px;
            }
        }

        .center-info {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none;
            z-index: 10;
        }

        .temperature-display {
            background: rgba(255, 255, 255, 0.4);
            border-radius: 12px;
            padding: 8px 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-width: 80px;
        }

        .temp-label {
            display: block;
            font-size: 0.7rem;
            font-weight: 500;
            color: #2d3748;
            margin-bottom: 2px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .temp-value {
            display: block;
            font-size: 1.2rem;
            font-weight: 700;
            color: #1a202c;
            line-height: 1;
        }

        .legend {
            margin-top: 24px;
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            justify-content: center;
            max-width: 600px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid rgba(113, 128, 150, 0.2);
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }

        .legend-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.12);
        }

        .legend-item.highlight {
            background: rgba(66, 153, 225, 0.1);
            border-color: rgba(66, 153, 225, 0.3);
            transform: translateY(-2px) scale(1.05);
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .legend-text {
            font-size: 0.9rem;
            font-weight: 500;
            color: #2d3748;
        }

        .legend-percentage {
            font-size: 0.85rem;
            font-weight: 600;
            color: #4a5568;
            margin-left: 4px;
        }

        .pie-slice {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .pie-slice:hover {
            filter: brightness(1.1) drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        .slice-label {
            font-size: 0.8rem;
            font-weight: 600;
            fill: #1a202c;
            text-anchor: middle;
            dominant-baseline: central;
            pointer-events: none;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }

        .axis {
            position: absolute;
            background: #333;
        }

        .axis-x {
            bottom: 80px;
            left: 80px;
            right: 80px;
            height: 2px;
        }

        .axis-y {
            left: 80px;
            bottom: 80px;
            top: 80px;
            width: 2px;
        }

        .eutectic-point {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #ff4757;
            border: 3px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 3px 10px rgba(255, 71, 87, 0.4);
            animation: pulse 2s infinite;
            cursor: pointer;
        }

        .eutectic-point:hover {
            transform: translate(-50%, -50%) scale(1.3);
        }

        .phase-line {
            position: absolute;
            background: #2196f3;
            height: 3px;
            transform-origin: left center;
            border-radius: 2px;
            box-shadow: 0 2px 5px rgba(33, 150, 243, 0.3);
        }

        .label {
            position: absolute;
            background: rgba(255,255,255,0.75);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.85em;
            font-weight: 600;
            color: #1a202c;
            border: 1px solid rgba(113, 128, 150, 0.3);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            backdrop-filter: blur(8px);
            white-space: nowrap;
        }

        .axis-label {
            position: absolute;
            font-weight: bold;
            color: #555;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0% { box-shadow: 0 3px 10px rgba(255, 71, 87, 0.4); }
            50% { box-shadow: 0 3px 20px rgba(255, 71, 87, 0.8); }
            100% { box-shadow: 0 3px 10px rgba(255, 71, 87, 0.4); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.8em;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .formula-display {
            background: linear-gradient(145deg, #edf2f7, #f7fafc);
            border: 1px solid rgba(113, 128, 150, 0.2);
            border-radius: 12px;
            padding: 20px;
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            font-size: 1rem;
            margin: 20px 0;
            color: #2d3748;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .nomenclature {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            padding: 32px;
            margin-top: 32px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.12);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nomenclature h3 {
            color: #2d3748;
            margin-bottom: 24px;
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        .nomenclature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .nomenclature-item {
            display: flex;
            align-items: center;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .nomenclature-symbol {
            font-weight: bold;
            margin-right: 10px;
            min-width: 20px;
        }

        .search-box {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(113, 128, 150, 0.2);
            border-radius: 10px;
            margin-bottom: 16px;
            font-size: 0.95rem;
            font-family: 'Lexend Deca', sans-serif;
            background: rgba(255, 255, 255, 0.9);
            color: #2d3748;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
            background: rgba(255, 255, 255, 1);
        }

        .category-badge {
            display: inline-block;
            background: #007bff;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7em;
            margin-left: 5px;
        }

        .organic { background: #28a745; }
        .salt { background: #475569; }
        .metal { background: #334155; }
        .nitrate { background: #64748b; color: #f1f5f9; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 16px 12px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
                margin-bottom: 24px;
            }
            
            .main-panel {
                padding: 20px 16px;
            }
            
            .controls-section {
                flex-direction: column;
                gap: 24px;
            }
            
            .material-selector,
            .calculation-panel {
                padding: 20px;
            }
            
            .material-selector h3,
            .calculation-panel h3,
            .composition-diagram h3,
            .nomenclature h3 {
                font-size: 1.3rem;
            }
            
            .dropdown-container {
                padding: 16px;
            }
            
            .material-select {
                padding: 12px 14px;
                font-size: 0.95rem;
            }
            
            .add-material-btn,
            .random-btn {
                padding: 14px 20px;
                font-size: 1rem;
            }
            
            .calculate-btn {
                padding: 14px 28px;
                font-size: 1.1rem;
            }
            
            .reset-btn {
                padding: 12px 24px;
                font-size: 1rem;
            }
            
            .pie-chart {
                max-width: 300px;
                max-height: 300px;
            }
            
            .legend {
                margin-top: 16px;
                gap: 12px;
            }
            
            .legend-item {
                padding: 6px 12px;
                font-size: 0.85rem;
            }
            
            .temperature-display {
                padding: 6px 12px;
                min-width: 70px;
            }
            
            .temp-value {
                font-size: 1rem;
            }
            
            .temp-label {
                font-size: 0.65rem;
            }
            
            .composition-diagram,
            .nomenclature {
                padding: 20px 16px;
            }
            
            .nomenclature-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .nomenclature-item {
                padding: 6px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 12px 8px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .main-panel {
                padding: 16px 12px;
            }
            
            .material-selector,
            .calculation-panel,
            .composition-diagram,
            .nomenclature {
                padding: 16px 12px;
            }
            
            .dropdown-container {
                padding: 12px;
                margin: 12px 0;
            }
            
            .pie-chart {
                max-width: 250px;
                max-height: 250px;
            }
            
            .legend {
                gap: 8px;
            }
            
            .legend-item {
                padding: 4px 8px;
                font-size: 0.8rem;
            }
            
            .legend-text {
                font-size: 0.8rem;
            }
            
            .legend-percentage {
                font-size: 0.75rem;
            }
            
            .temperature-display {
                padding: 4px 8px;
                min-width: 60px;
            }
            
            .temp-value {
                font-size: 0.9rem;
            }
            
            .temp-label {
                font-size: 0.6rem;
            }
            
            .random-options {
                padding: 12px;
            }
            
            .random-controls {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }
            
            .random-select {
                width: 100%;
                padding: 6px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Calculateur d'Eutectiques n-aires</h1>
        <p class="subtitle">Application aux liquides ioniques et m√©langes fusibles</p>
        
        <div class="main-panel">
            <div class="controls-section">
                <div class="material-selector">
                    <h3>üß™ S√©lecteur de Mat√©riaux</h3>
                    <div id="materialDropdowns">
                        <!-- Dropdowns seront ajout√©s ici -->
                    </div>
                    <button class="add-material-btn" id="addMaterialBtn">
                        ‚ûï Ajouter un mat√©riau
                    </button>
                    
                    <div class="test-cases">
                        <h4>üß™ Cas tests de la publication</h4>
                        <button class="test-case-btn" id="testCase1">
                            ü•à Ag-Si (Binaire)
                        </button>
                        <button class="test-case-btn" id="testCase2">
                            üßÇ KCl-LiCl-NaCl (Ternaire)
                        </button>
                        <button class="test-case-btn" id="testCase3">
                            üåã KNO‚ÇÉ-LiNO‚ÇÉ-NaNO‚ÇÉ (Ternaire)
                        </button>
                    </div>
                    
                    <div class="genetic-algorithm">
                        <h4>üß¨ Optimisation par Algorithme G√©n√©tique</h4>
                        <div class="genetic-controls">
                            <div class="control-group">
                                <label for="targetTemp">Temp√©rature cible (¬∞C):</label>
                                <input type="number" id="targetTemp" class="genetic-input" value="100" min="-200" max="1500" step="0.1">
                            </div>
                            <div class="control-group">
                                <label for="minComponents">Composants min:</label>
                                <select id="minComponents" class="genetic-select">
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                </select>
                            </div>
                            <div class="control-group">
                                <label for="maxComponents">Composants max:</label>
                                <select id="maxComponents" class="genetic-select">
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7" selected>7</option>
                                </select>
                            </div>
                        </div>
                        <button class="genetic-btn" id="startGeneticBtn">
                            üß† Recherche optimale
                        </button>
                        <div class="genetic-progress" id="geneticProgress">
                            <div class="progress-bar" id="progressBar"></div>
                            <div class="progress-text" id="progressText">En attente...</div>
                        </div>
                        <div class="genetic-results" id="geneticResults">
                            <!-- R√©sultats de l'algorithme g√©n√©tique -->
                        </div>
                    </div>
                </div>
                
                <div class="calculation-panel">
                    <h3>‚öóÔ∏è Calcul Eutectique</h3>
                    
                    <button class="reset-btn" id="resetBtn">
                        üîÑ R√©initialiser
                    </button>
                    
                    <button class="calculate-btn" id="calculateBtn">
                        Calculer l'Eutectique
                    </button>
                    
                    <div class="loading" id="loading">
                        <div class="spinner"></div>
                        <p>Calcul en cours...</p>
                    </div>
                    
                    <div class="results" id="results">
                        <!-- R√©sultats seront affich√©s ici -->
                    </div>
                    
                    <div class="formula-display">
                        <strong>√âquation utilis√©e:</strong><br>
                        ln(x<sub>i</sub>) + H<sub>i</sub>/R √ó (1/T - 1/T<sub>i</sub>¬∞) = 0
                    </div>
                </div>
            </div>
            
            <div class="composition-diagram">
                <h3>üç∞ Diagramme de Composition Eutectique</h3>
                <div class="pie-container" id="pieContainer">
                    <svg class="pie-chart" id="pieChart" width="400" height="400" viewBox="0 0 400 400">
                        <!-- Le diagramme circulaire sera g√©n√©r√© ici -->
                    </svg>
                    <div class="center-info" id="centerInfo">
                        <div class="temperature-display">
                            <span class="temp-label">Temp√©rature</span>
                            <span class="temp-value" id="tempValue">--</span>
                        </div>
                    </div>
                    <div class="legend" id="legend">
                        <!-- L√©gende sera g√©n√©r√©e ici -->
                    </div>
                </div>
            </div>
            
            <div class="nomenclature">
                <h3>üìù Nomenclature</h3>
                <div class="nomenclature-grid">
                    <div class="nomenclature-item">
                        <span class="nomenclature-symbol">G</span>
                        <span>Enthalpie libre (J/mol/K)</span>
                    </div>
                    <div class="nomenclature-item">
                        <span class="nomenclature-symbol">Œº</span>
                        <span>Potentiel chimique</span>
                    </div>
                    <div class="nomenclature-item">
                        <span class="nomenclature-symbol">R</span>
                        <span>Constante des gaz parfaits (8,314510 J/mol/K)</span>
                    </div>
                    <div class="nomenclature-item">
                        <span class="nomenclature-symbol">H¬∞</span>
                        <span>Enthalpie de fusion (J/mol)</span>
                    </div>
                    <div class="nomenclature-item">
                        <span class="nomenclature-symbol">T</span>
                        <span>Temp√©rature (K)</span>
                    </div>
                    <div class="nomenclature-item">
                        <span class="nomenclature-symbol">x</span>
                        <span>Fraction molaire</span>
                    </div>
                    <div class="nomenclature-item">
                        <span class="nomenclature-symbol">a</span>
                        <span>Activit√© (J/mol)</span>
                    </div>
                    <div class="nomenclature-item">
                        <span class="nomenclature-symbol">S</span>
                        <span>Entropie (J/mol/K)</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tooltip" id="tooltip"></div>
    </div>

    <script>
        $(document).ready(function() {
            // Base de donn√©es √©tendue avec compos√©s organiques et inorganiques
            const materials = [
                // M√©taux
                { name: "Argent (Ag)", hfus: 11300, tfus: 960.85, category: "M√©tal", formula: "Ag" },
                { name: "Aluminium (Al)", hfus: 10790, tfus: 660.32, category: "M√©tal", formula: "Al" },
                { name: "Cuivre (Cu)", hfus: 13260, tfus: 1084.62, category: "M√©tal", formula: "Cu" },
                { name: "Zinc (Zn)", hfus: 7322, tfus: 419.53, category: "M√©tal", formula: "Zn" },
                { name: "Plomb (Pb)", hfus: 4770, tfus: 327.46, category: "M√©tal", formula: "Pb" },
                { name: "√âtain (Sn)", hfus: 7029, tfus: 231.93, category: "M√©tal", formula: "Sn" },
                
                // Semi-conducteurs
                { name: "Silicium (Si)", hfus: 46000, tfus: 1414.85, category: "Semi-conducteur", formula: "Si" },
                { name: "Germanium (Ge)", hfus: 31800, tfus: 938.25, category: "Semi-conducteur", formula: "Ge" },
                
                // Sels halog√©n√©s
                { name: "Chlorure de potassium", hfus: 25500, tfus: 772, category: "Sel", formula: "KCl" },
                { name: "Chlorure de lithium", hfus: 13400, tfus: 610, category: "Sel", formula: "LiCl" },
                { name: "Chlorure de sodium", hfus: 28500, tfus: 808, category: "Sel", formula: "NaCl" },
                { name: "Chlorure d'aluminium", hfus: 35100, tfus: 190, category: "Sel", formula: "AlCl‚ÇÉ" },
                { name: "Bromure de potassium", hfus: 29300, tfus: 734, category: "Sel", formula: "KBr" },
                { name: "Bromure de lithium", hfus: 12100, tfus: 547, category: "Sel", formula: "LiBr" },
                { name: "Fluorure de potassium", hfus: 28500, tfus: 856, category: "Sel", formula: "KF" },
                { name: "Fluorure de lithium", hfus: 10000, tfus: 845, category: "Sel", formula: "LiF" },
                { name: "Fluorure de sodium", hfus: 32600, tfus: 995, category: "Sel", formula: "NaF" },
                { name: "Iodure de sodium", hfus: 23600, tfus: 661, category: "Sel", formula: "NaI" },
                { name: "Iodure de potassium", hfus: 24000, tfus: 681, category: "Sel", formula: "KI" },
                
                // Nitrates
                { name: "Nitrate de potassium", hfus: 11700, tfus: 337, category: "Nitrate", formula: "KNO‚ÇÉ" },
                { name: "Nitrate de lithium", hfus: 25500, tfus: 254, category: "Nitrate", formula: "LiNO‚ÇÉ" },
                { name: "Nitrate de sodium", hfus: 15900, tfus: 310, category: "Nitrate", formula: "NaNO‚ÇÉ" },
                { name: "Nitrate d'argent", hfus: 11500, tfus: 210, category: "Nitrate", formula: "AgNO‚ÇÉ" },
                { name: "Nitrate de thallium", hfus: 9600, tfus: 206, category: "Nitrate", formula: "TlNO‚ÇÉ" },
                { name: "Nitrate de calcium", hfus: 23400, tfus: 561, category: "Nitrate", formula: "Ca(NO‚ÇÉ)‚ÇÇ" },
                
                // Hydroxydes
                { name: "Hydroxyde de potassium", hfus: 7500, tfus: 360, category: "Hydroxyde", formula: "KOH" },
                { name: "Hydroxyde de sodium", hfus: 7100, tfus: 318, category: "Hydroxyde", formula: "NaOH" },
                { name: "Hydroxyde de lithium", hfus: 8790, tfus: 462, category: "Hydroxyde", formula: "LiOH" },
                
                // Sulfates
                { name: "Sulfate de potassium", hfus: 36700, tfus: 1074, category: "Sulfate", formula: "K‚ÇÇSO‚ÇÑ" },
                { name: "Sulfate de lithium", hfus: 12600, tfus: 859, category: "Sulfate", formula: "Li‚ÇÇSO‚ÇÑ" },
                { name: "Sulfate de sodium", hfus: 24300, tfus: 884, category: "Sulfate", formula: "Na‚ÇÇSO‚ÇÑ" },
                
                // Compos√©s organiques - Alcanes
                { name: "n-Hexane", hfus: 13080, tfus: -95.3, category: "Alcane", formula: "C‚ÇÜH‚ÇÅ‚ÇÑ" },
                { name: "n-Heptane", hfus: 14160, tfus: -90.6, category: "Alcane", formula: "C‚ÇáH‚ÇÅ‚ÇÜ" },
                { name: "n-Octane", hfus: 20730, tfus: -56.8, category: "Alcane", formula: "C‚ÇàH‚ÇÅ‚Çà" },
                { name: "n-D√©cane", hfus: 28720, tfus: -29.7, category: "Alcane", formula: "C‚ÇÅ‚ÇÄH‚ÇÇ‚ÇÇ" },
                { name: "n-Dod√©cane", hfus: 36800, tfus: -9.6, category: "Alcane", formula: "C‚ÇÅ‚ÇÇH‚ÇÇ‚ÇÜ" },
                { name: "n-Hexad√©cane", hfus: 53360, tfus: 18.2, category: "Alcane", formula: "C‚ÇÅ‚ÇÜH‚ÇÉ‚ÇÑ" },
                { name: "n-Eicosane", hfus: 69900, tfus: 36.8, category: "Alcane", formula: "C‚ÇÇ‚ÇÄH‚ÇÑ‚ÇÇ" },
                
                // Acides carboxyliques
                { name: "Acide ac√©tique", hfus: 11730, tfus: 16.6, category: "Acide", formula: "CH‚ÇÉCOOH" },
                { name: "Acide propionique", hfus: 10660, tfus: -20.5, category: "Acide", formula: "C‚ÇÇH‚ÇÖCOOH" },
                { name: "Acide butyrique", hfus: 11590, tfus: -5.1, category: "Acide", formula: "C‚ÇÉH‚ÇáCOOH" },
                { name: "Acide st√©arique", hfus: 61900, tfus: 69.3, category: "Acide", formula: "C‚ÇÅ‚ÇàH‚ÇÉ‚ÇÜO‚ÇÇ" },
                { name: "Acide palmitique", hfus: 53150, tfus: 63.1, category: "Acide", formula: "C‚ÇÅ‚ÇÜH‚ÇÉ‚ÇÇO‚ÇÇ" },
                { name: "Acide laurique", hfus: 36300, tfus: 44.0, category: "Acide", formula: "C‚ÇÅ‚ÇÇH‚ÇÇ‚ÇÑO‚ÇÇ" },
                { name: "Acide benzo√Øque", hfus: 17870, tfus: 122.4, category: "Acide", formula: "C‚ÇáH‚ÇÜO‚ÇÇ" },
                
                // Alcools
                { name: "M√©thanol", hfus: 3215, tfus: -97.7, category: "Alcool", formula: "CH‚ÇÉOH" },
                { name: "√âthanol", hfus: 4931, tfus: -114.1, category: "Alcool", formula: "C‚ÇÇH‚ÇÖOH" },
                { name: "Propanol-1", hfus: 5370, tfus: -126.2, category: "Alcool", formula: "C‚ÇÉH‚ÇáOH" },
                { name: "Butanol-1", hfus: 9280, tfus: -89.8, category: "Alcool", formula: "C‚ÇÑH‚ÇâOH" },
                { name: "Pentanol-1", hfus: 9850, tfus: -78.9, category: "Alcool", formula: "C‚ÇÖH‚ÇÅ‚ÇÅOH" },
                { name: "Hexanol-1", hfus: 15380, tfus: -44.6, category: "Alcool", formula: "C‚ÇÜH‚ÇÅ‚ÇÉOH" },
                { name: "Octanol-1", hfus: 23700, tfus: -16.7, category: "Alcool", formula: "C‚ÇàH‚ÇÅ‚ÇáOH" },
                { name: "D√©canol-1", hfus: 28000, tfus: 6.4, category: "Alcool", formula: "C‚ÇÅ‚ÇÄH‚ÇÇ‚ÇÅOH" },
                
                // Compos√©s aromatiques
                { name: "Benz√®ne", hfus: 9870, tfus: 5.5, category: "Aromatique", formula: "C‚ÇÜH‚ÇÜ" },
                { name: "Tolu√®ne", hfus: 6640, tfus: -95.0, category: "Aromatique", formula: "C‚ÇáH‚Çà" },
                { name: "Ph√©nol", hfus: 11510, tfus: 40.9, category: "Aromatique", formula: "C‚ÇÜH‚ÇÖOH" },
                { name: "Aniline", hfus: 10540, tfus: -6.0, category: "Aromatique", formula: "C‚ÇÜH‚ÇÖNH‚ÇÇ" },
                { name: "Naphtal√®ne", hfus: 19290, tfus: 80.2, category: "Aromatique", formula: "C‚ÇÅ‚ÇÄH‚Çà" },
                { name: "Anthrac√®ne", hfus: 28830, tfus: 218.0, category: "Aromatique", formula: "C‚ÇÅ‚ÇÑH‚ÇÅ‚ÇÄ" },
                
                // Esters
                { name: "Ac√©tate d'√©thyle", hfus: 10480, tfus: -83.6, category: "Ester", formula: "CH‚ÇÉCOOC‚ÇÇH‚ÇÖ" },
                { name: "Ac√©tate de m√©thyle", hfus: 7490, tfus: -98.1, category: "Ester", formula: "CH‚ÇÉCOOCH‚ÇÉ" },
                { name: "Ac√©tate de butyle", hfus: 14270, tfus: -73.5, category: "Ester", formula: "CH‚ÇÉCOOC‚ÇÑH‚Çâ" },
                
                // C√©tones
                { name: "Ac√©tone", hfus: 5690, tfus: -94.7, category: "C√©tone", formula: "CH‚ÇÉCOCH‚ÇÉ" },
                { name: "Butanone (MEK)", hfus: 8440, tfus: -86.7, category: "C√©tone", formula: "CH‚ÇÉCOC‚ÇÇH‚ÇÖ" },
                { name: "Cyclohexanone", hfus: 1328, tfus: -47.0, category: "C√©tone", formula: "C‚ÇÜH‚ÇÅ‚ÇÄO" },
                
                // √âthers
                { name: "Di√©thyl √©ther", hfus: 7190, tfus: -116.3, category: "√âther", formula: "C‚ÇÇH‚ÇÖOC‚ÇÇH‚ÇÖ" },
                { name: "T√©trahydrofurane (THF)", hfus: 8540, tfus: -108.4, category: "√âther", formula: "C‚ÇÑH‚ÇàO" },
                
                // Liquides ioniques et eutectiques profonds
                { name: "Chlorure de choline", hfus: 14790, tfus: 133.0, category: "Liquide ionique", formula: "C‚ÇÖH‚ÇÅ‚ÇÑClNO" },
                { name: "Ur√©e", hfus: 15300, tfus: 133.3, category: "Organique", formula: "CH‚ÇÑN‚ÇÇO" },
                { name: "Glyc√©rol", hfus: 18300, tfus: 17.8, category: "Alcool", formula: "C‚ÇÉH‚ÇàO‚ÇÉ" },
                { name: "√âthyl√®ne glycol", hfus: 9960, tfus: -12.9, category: "Alcool", formula: "C‚ÇÇH‚ÇÜO‚ÇÇ" },
                { name: "Acide malique", hfus: 31500, tfus: 131.0, category: "Acide", formula: "C‚ÇÑH‚ÇÜO‚ÇÖ" },
                { name: "Acide citrique", hfus: 39100, tfus: 156.0, category: "Acide", formula: "C‚ÇÜH‚ÇàO‚Çá" },
                { name: "Glucose", hfus: 31400, tfus: 146.0, category: "Sucre", formula: "C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ" },
                { name: "Fructose", hfus: 33100, tfus: 103.0, category: "Sucre", formula: "C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ" },
                { name: "Saccharose", hfus: 35600, tfus: 186.0, category: "Sucre", formula: "C‚ÇÅ‚ÇÇH‚ÇÇ‚ÇÇO‚ÇÅ‚ÇÅ" },
                
                // Amines
                { name: "Tri√©thylamine", hfus: 9200, tfus: -114.7, category: "Amine", formula: "(C‚ÇÇH‚ÇÖ)‚ÇÉN" },
                { name: "Dipropylamine", hfus: 17100, tfus: -63.0, category: "Amine", formula: "(C‚ÇÉH‚Çá)‚ÇÇNH" },
                
                // Compos√©s halog√©n√©s organiques
                { name: "Chloroforme", hfus: 8800, tfus: -63.5, category: "Halog√©n√©", formula: "CHCl‚ÇÉ" },
                { name: "T√©trachlorure de carbone", hfus: 2500, tfus: -22.9, category: "Halog√©n√©", formula: "CCl‚ÇÑ" },
                { name: "Dichlorom√©thane", hfus: 6200, tfus: -96.7, category: "Halog√©n√©", formula: "CH‚ÇÇCl‚ÇÇ" }
            ];

            let materialDropdowns = [];
            let dropdownCounter = 0;
            const Rg = 8.314510; // Constante des gaz parfaits
            const To = 273.15; // Conversion K->¬∞C

            // Initialiser avec deux dropdowns par d√©faut
            function initializeDropdowns() {
                addMaterialDropdown();
                addMaterialDropdown();
            }

            // Cr√©er un nouveau dropdown de mat√©riau
            function addMaterialDropdown() {
                dropdownCounter++;
                const dropdownId = `dropdown_${dropdownCounter}`;
                
                const $dropdown = $(`
                    <div class="dropdown-container" data-id="${dropdownId}">
                        <div class="dropdown-header">
                            <label><strong>Mat√©riau ${dropdownCounter}:</strong></label>
                            ${dropdownCounter > 2 ? '<button class="remove-btn" onclick="removeDropdown(\'' + dropdownId + '\')">‚úï Retirer</button>' : ''}
                        </div>
                        <input type="text" class="search-box" placeholder="Rechercher un mat√©riau..." onkeyup="filterOptions('${dropdownId}')">
                        <select class="material-select" onchange="updateMaterialInfo('${dropdownId}')">
                            <option value="">S√©lectionnez un mat√©riau...</option>
                        </select>
                        <div class="material-info" id="info_${dropdownId}"></div>
                    </div>
                `);
                
                $('#materialDropdowns').append($dropdown);
                populateDropdown(dropdownId);
                materialDropdowns.push(dropdownId);
                updateCalculateButton();
            }

            // Peupler un dropdown avec les mat√©riaux
            function populateDropdown(dropdownId) {
                const $select = $(`[data-id="${dropdownId}"] .material-select`);
                $select.find('option:not(:first)').remove();
                
                materials.forEach((material, index) => {
                    const categoryClass = material.category.toLowerCase().replace(/[^a-z]/g, '');
                    $select.append(`
                        <option value="${index}" data-category="${material.category}">
                            ${material.name} (${material.formula}) 
                            - T¬∞: ${material.tfus}¬∞C 
                            - H¬∞: ${material.hfus} J/mol
                            <span class="category-badge ${categoryClass}">${material.category}</span>
                        </option>
                    `);
                });
            }

            // Filtrer les options du dropdown
            window.filterOptions = function(dropdownId) {
                const searchTerm = $(`[data-id="${dropdownId}"] .search-box`).val().toLowerCase();
                const $select = $(`[data-id="${dropdownId}"] .material-select`);
                
                $select.find('option').each(function() {
                    const text = $(this).text().toLowerCase();
                    if (text.includes(searchTerm) || $(this).val() === '') {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
            };

            // Mettre √† jour les informations du mat√©riau s√©lectionn√©
            window.updateMaterialInfo = function(dropdownId) {
                const $select = $(`[data-id="${dropdownId}"] .material-select`);
                const $info = $(`#info_${dropdownId}`);
                const selectedIndex = $select.val();
                
                if (selectedIndex !== '') {
                    const material = materials[selectedIndex];
                    $info.html(`
                        <strong>${material.name}</strong> (${material.formula})<br>
                        <span class="category-badge ${material.category.toLowerCase()}">${material.category}</span><br>
                        <strong>Temp√©rature de fusion:</strong> ${material.tfus}¬∞C<br>
                        <strong>Enthalpie de fusion:</strong> ${material.hfus} J/mol
                    `).addClass('show');
                } else {
                    $info.removeClass('show');
                }
                
                updateCalculateButton();
            };

            // Retirer un dropdown
            window.removeDropdown = function(dropdownId) {
                $(`[data-id="${dropdownId}"]`).fadeOut(300, function() {
                    $(this).remove();
                    materialDropdowns = materialDropdowns.filter(id => id !== dropdownId);
                    updateCalculateButton();
                    renumberDropdowns();
                });
            };

            // Renum√©roter les dropdowns apr√®s suppression
            function renumberDropdowns() {
                $('#materialDropdowns .dropdown-container').each(function(index) {
                    $(this).find('label').html(`<strong>Mat√©riau ${index + 1}:</strong>`);
                });
            }

            // Obtenir les mat√©riaux s√©lectionn√©s
            function getSelectedMaterials() {
                const selected = [];
                $('#materialDropdowns .material-select').each(function() {
                    const index = $(this).val();
                    if (index !== '') {
                        selected.push(materials[index]);
                    }
                });
                return selected;
            }

            // Mettre √† jour le bouton de calcul
            function updateCalculateButton() {
                const selectedMaterials = getSelectedMaterials();
                const $btn = $('#calculateBtn');
                
                if (selectedMaterials.length >= 2) {
                    const systemType = selectedMaterials.length === 2 ? 'binaire' : 
                                      selectedMaterials.length === 3 ? 'ternaire' : 
                                      `${selectedMaterials.length}-aire`;
                    $btn.prop('disabled', false).text(`Calculer l'Eutectique ${systemType} (${selectedMaterials.length} mat√©riaux)`);
                } else {
                    $btn.prop('disabled', true).text('S√©lectionnez au moins 2 mat√©riaux');
                }
            }

            // Algorithme de calcul eutectique (Newton-Raphson)
            function calculateEutectic(materials) {
                const n = materials.length;
                let X = new Array(n + 1);
                let F = new Array(n + 1);
                let Jc = Array(n + 1).fill().map(() => Array(n + 1).fill(0));
                let Dx = new Array(n + 1);
                
                // Initialisation
                for (let i = 1; i <= n; i++) {
                    X[i] = 1.0 / n; // Fractions molaires initiales
                }
                X[n] = materials[0].tfus + To; // Temp√©rature initiale en K
                
                const relax = 0.1; // Facteur de sous-relaxation
                const tolerance = 0.00001;
                let maxIterations = 100;
                let iteration = 0;
                
                while (iteration < maxIterations) {
                    // Construction de la matrice jacobienne
                    for (let i = 1; i <= n; i++) {
                        for (let j = 1; j <= n + 1; j++) {
                            Jc[i][j] = 0;
                        }
                        
                        if (i < n) {
                            Jc[i][i] = 1.0 / X[i];
                        } else {
                            let coef = 1;
                            for (let j = 1; j < n; j++) {
                                coef -= X[j];
                            }
                            for (let j = 1; j < n; j++) {
                                Jc[j][i] = -1.0 / coef;
                            }
                        }
                        
                        const material = materials[i - 1];
                        Jc[n][i] = -material.hfus / Rg / (X[n] * X[n]);
                    }
                    
                    // Calcul des fonctions F[i]
                    for (let i = 1; i <= n; i++) {
                        const material = materials[i - 1];
                        let g;
                        
                        if (i < n) {
                            g = Math.log(X[i]) + material.hfus / Rg * (1.0 / X[n] - 1.0 / (material.tfus + To));
                        } else {
                            let coef = 1;
                            for (let j = 1; j < n; j++) {
                                coef -= X[j];
                            }
                            g = Math.log(coef) + material.hfus / Rg * (1.0 / X[n] - 1.0 / (material.tfus + To));
                        }
                        
                        F[i] = g;
                    }
                    
                    // R√©solution du syst√®me lin√©aire (m√©thode de Gauss-Jordan simplifi√©e)
                    for (let i = 1; i <= n; i++) {
                        let u = Jc[i][i];
                        if (Math.abs(u) < 1e-10) continue;
                        
                        Jc[i][i] = 1.0;
                        for (let j = 1; j <= n; j++) {
                            Jc[i][j] /= u;
                        }
                        
                        for (let k = 1; k <= n; k++) {
                            if (k !== i) {
                                u = Jc[k][i];
                                Jc[k][i] = 0;
                                for (let l = 1; l <= n; l++) {
                                    Jc[k][l] -= u * Jc[i][l];
                                }
                            }
                        }
                    }
                    
                    // Calcul des corrections Dx
                    for (let i = 1; i <= n; i++) {
                        Dx[i] = 0;
                        for (let j = 1; j <= n; j++) {
                            Dx[i] += Jc[j][i] * F[j];
                        }
                    }
                    
                    // Mise √† jour avec sous-relaxation
                    for (let i = 1; i <= n; i++) {
                        X[i] -= relax * Dx[i];
                    }
                    
                    // Test de convergence
                    let residue = 0;
                    for (let i = 1; i < n; i++) {
                        residue += Math.abs(Dx[i]);
                    }
                    
                    if (residue < tolerance) {
                        break;
                    }
                    
                    iteration++;
                }
                
                // Pr√©paration des r√©sultats
                let results = [];
                let totalX = 0;
                for (let i = 1; i < n; i++) {
                    totalX += X[i];
                    results.push({
                        material: materials[i - 1].name,
                        formula: materials[i - 1].formula,
                        fraction: X[i],
                        hfus: materials[i - 1].hfus,
                        tfus: materials[i - 1].tfus,
                        category: materials[i - 1].category
                    });
                }
                
                // Dernier mat√©riau
                results.push({
                    material: materials[n - 1].name,
                    formula: materials[n - 1].formula,
                    fraction: 1.0 - totalX,
                    hfus: materials[n - 1].hfus,
                    tfus: materials[n - 1].tfus,
                    category: materials[n - 1].category
                });
                
                return {
                    temperature: X[n] - To,
                    temperatureK: X[n],
                    compositions: results,
                    converged: iteration < maxIterations
                };
            }

            // Affichage des r√©sultats
            function displayResults(result) {
                const $results = $('#results');
                const selectedMaterials = getSelectedMaterials();
                
                let html = '<h4>üéØ R√©sultats du calcul eutectique</h4>';
                html += `<div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 10px 0;">`;
                html += `<strong>Temp√©rature eutectique: ${result.temperature.toFixed(1)}¬∞C (${result.temperatureK.toFixed(1)}K)</strong>`;
                html += `</div>`;
                
                html += `<div style="margin-top: 15px;"><strong>Compositions du syst√®me ${selectedMaterials.length}-aire:</strong></div>`;
                
                result.compositions.forEach(comp => {
                    const percentage = (comp.fraction * 100).toFixed(1);
                    const categoryClass = comp.category.toLowerCase().replace(/[^a-z]/g, '');
                    html += `
                        <div style="background: #f8f9fa; padding: 10px; margin: 5px 0; border-radius: 5px; border-left: 3px solid #007bff;">
                            <strong>${comp.material}</strong> (${comp.formula}): ${percentage}% molaire 
                            <span class="category-badge ${categoryClass}">${comp.category}</span><br>
                            <span style="color: #666; font-size: 0.9em;">
                                H¬∞: ${comp.hfus} J/mol, T¬∞: ${comp.tfus}¬∞C
                            </span>
                        </div>
                    `;
                });
                
                if (!result.converged) {
                    html += '<div style="color: #dc3545; margin-top: 10px; font-style: italic;">‚ö†Ô∏è Attention: Le calcul n\'a pas compl√®tement converg√©</div>';
                }
                
                $results.html(html);
                $results.addClass('show');
            }

            // Mise √† jour du diagramme circulaire
            function updateCompositionDiagram(result) {
                const $svg = $('#pieChart');
                const $centerInfo = $('#centerInfo');
                const $legend = $('#legend');
                
                // Effacer les √©l√©ments pr√©c√©dents
                $svg.empty();
                $legend.empty();
                
                // Afficher la temp√©rature au centre
                $('#tempValue').text(`${result.temperature.toFixed(1)}¬∞C`);
                
                // Palette de couleurs distinctes pour chaque composant
                const distinctColors = [
                    '#e53e3e',  // Rouge
                    '#4299e1',  // Bleu
                    '#48bb78',  // Vert
                    '#ed8936',  // Orange
                    '#9f7aea',  // Violet
                    '#38b2ac',  // Teal
                    '#f687b3',  // Rose
                    '#fbd38d',  // Jaune clair
                    '#90cdf4',  // Bleu clair
                    '#68d391',  // Vert clair
                    '#fc8181',  // Rouge clair
                    '#a78bfa',  // Violet clair
                    '#4fd1c7',  // Cyan
                    '#f6ad55',  // Orange clair
                    '#81e6d9',  // Turquoise
                    '#feb2b2',  // Rose clair
                    '#c6f6d5',  // Vert tr√®s clair
                    '#bee3f8',  // Bleu tr√®s clair
                    '#e9d8fd',  // Violet tr√®s clair
                    '#fed7d7'   // Rouge tr√®s clair
                ];
                
                // Calculer les angles pour chaque segment
                const total = result.compositions.reduce((sum, comp) => sum + comp.fraction, 0);
                let currentAngle = 0; // Commencer √† 0 degr√©s (3 heures)
                
                const centerX = 200;
                const centerY = 200;
                const radius = 140;
                
                console.log('Updating pie chart with', result.compositions.length, 'components');
                
                // Cr√©er les segments du diagramme circulaire
                result.compositions.forEach((comp, index) => {
                    const percentage = comp.fraction / total;
                    const angleRad = percentage * 2 * Math.PI;
                    const endAngle = currentAngle + angleRad;
                    
                    console.log(`Component ${index}: ${comp.material}, ${(percentage * 100).toFixed(1)}%, angle: ${angleRad}`);
                    
                    // Assigner une couleur unique √† chaque composant
                    const color = distinctColors[index % distinctColors.length];
                    
                    // Calculer les coordonn√©es du segment
                    const startX = centerX + radius * Math.cos(currentAngle);
                    const startY = centerY + radius * Math.sin(currentAngle);
                    const endX = centerX + radius * Math.cos(endAngle);
                    const endY = centerY + radius * Math.sin(endAngle);
                    
                    // Cr√©er le chemin SVG pour le segment
                    let pathData;
                    if (angleRad >= 2 * Math.PI) {
                        // Cercle complet pour un seul composant
                        pathData = `M ${centerX} ${centerY} m -${radius}, 0 a ${radius},${radius} 0 1,1 ${radius*2},0 a ${radius},${radius} 0 1,1 -${radius*2},0`;
                    } else {
                        const largeArcFlag = angleRad > Math.PI ? 1 : 0;
                        pathData = [
                            `M ${centerX} ${centerY}`,
                            `L ${startX} ${startY}`,
                            `A ${radius} ${radius} 0 ${largeArcFlag} 1 ${endX} ${endY}`,
                            'Z'
                        ].join(' ');
                    }
                    
                    // Cr√©er l'√©l√©ment path avec namespace SVG
                    const pathElement = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    pathElement.setAttribute('class', 'pie-slice');
                    pathElement.setAttribute('d', pathData);
                    pathElement.setAttribute('fill', color);
                    pathElement.setAttribute('stroke', 'rgba(255,255,255,0.8)');
                    pathElement.setAttribute('stroke-width', '2');
                    pathElement.setAttribute('data-material', comp.material);
                    pathElement.setAttribute('data-percentage', (percentage * 100).toFixed(1));
                    
                    $svg[0].appendChild(pathElement);
                    
                    // Ajouter le label du pourcentage si le segment est assez grand
                    if (percentage > 0.05) { // Plus de 5%
                        const labelAngle = currentAngle + angleRad / 2;
                        const labelRadius = radius * 0.7;
                        const labelX = centerX + labelRadius * Math.cos(labelAngle);
                        const labelY = centerY + labelRadius * Math.sin(labelAngle);
                        
                        const textElement = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                        textElement.setAttribute('class', 'slice-label');
                        textElement.setAttribute('x', labelX);
                        textElement.setAttribute('y', labelY);
                        textElement.setAttribute('text-anchor', 'middle');
                        textElement.setAttribute('dominant-baseline', 'central');
                        textElement.textContent = `${(percentage * 100).toFixed(1)}%`;
                        
                        $svg[0].appendChild(textElement);
                    }
                    
                    currentAngle = endAngle;
                    
                    // Cr√©er l'√©l√©ment de l√©gende
                    const $legendItem = $(`
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: ${color};"></div>
                            <span class="legend-text">${comp.material}</span>
                            <span class="legend-percentage">${(percentage * 100).toFixed(1)}%</span>
                        </div>
                    `);
                    
                    $legend.append($legendItem);
                });
                
                // Ajouter les interactions hover
                $('.pie-slice').on('mouseenter', function(e) {
                    const material = $(this).data('material');
                    const percentage = $(this).data('percentage');
                    
                    // Mettre en surbrillance l'√©l√©ment de l√©gende correspondant
                    $('.legend-item').removeClass('highlight');
                    $('.legend-item').filter(function() {
                        return $(this).find('.legend-text').text() === material;
                    }).addClass('highlight');
                    
                    // Afficher tooltip
                    showTooltip(`${material}: ${percentage}%`, e);
                }).on('mouseleave', function() {
                    $('.legend-item').removeClass('highlight');
                    hideTooltip();
                });
            }
            
            // Fonctions pour tooltip
            function showTooltip(text, event) {
                const $tooltip = $('<div class="chart-tooltip"></div>')
                    .text(text)
                    .css({
                        position: 'fixed',
                        background: 'rgba(0,0,0,0.8)',
                        color: 'white',
                        padding: '8px 12px',
                        borderRadius: '6px',
                        fontSize: '0.9rem',
                        zIndex: 9999,
                        pointerEvents: 'none',
                        left: event.pageX + 10,
                        top: event.pageY - 10
                    });
                
                $('body').append($tooltip);
            }
            
            function hideTooltip() {
                $('.chart-tooltip').remove();
            }

            // R√©initialiser l'application
            function resetApplication() {
                // Supprimer tous les dropdowns sauf les deux premiers
                $('#materialDropdowns .dropdown-container').each(function(index) {
                    if (index > 1) {
                        $(this).remove();
                    } else {
                        $(this).find('.material-select').val('');
                        $(this).find('.search-box').val('');
                        $(this).find('.material-info').removeClass('show');
                    }
                });
                
                // R√©initialiser les variables
                materialDropdowns = materialDropdowns.slice(0, 2);
                
                // Effacer les r√©sultats
                $('#results').removeClass('show');
                $('#diagramContainer .eutectic-point, #diagramContainer .phase-line, #diagramContainer .label').remove();
                
                updateCalculateButton();
            }

            // Cas de test de la publication
            const testCases = {
                case1: {
                    name: 'Syst√®me Ag-Si (Binaire)',
                    materials: ['Argent (Ag)', 'Silicium (Si)'],
                    description: 'Syst√®me m√©tal-semi-conducteur classique'
                },
                case2: {
                    name: 'Syst√®me KCl-LiCl-NaCl (Ternaire)',
                    materials: ['Chlorure de potassium', 'Chlorure de lithium', 'Chlorure de sodium'],
                    description: 'Syst√®me de chlorures alcalins'
                },
                case3: {
                    name: 'Syst√®me KNO‚ÇÉ-LiNO‚ÇÉ-NaNO‚ÇÉ (Ternaire)',
                    materials: ['Nitrate de potassium', 'Nitrate de lithium', 'Nitrate de sodium'],
                    description: 'Syst√®me de nitrates alcalins'
                }
            };
            
            // Charger un cas de test
            function loadTestCase(caseKey) {
                const testCase = testCases[caseKey];
                if (!testCase) return;
                
                // R√©initialiser l'application
                resetApplication();
                
                // Ajouter les dropdowns n√©cessaires
                while (materialDropdowns.length < testCase.materials.length) {
                    addMaterialDropdown();
                }
                
                // Appliquer les s√©lections
                testCase.materials.forEach((materialName, index) => {
                    const materialIndex = materials.findIndex(m => m.name === materialName);
                    if (materialIndex !== -1) {
                        const dropdownId = materialDropdowns[index];
                        $(`[data-id="${dropdownId}"] .material-select`).val(materialIndex).trigger('change');
                    }
                });
                
                // Afficher un message de succ√®s
                showNotification(`üß™ ${testCase.name} charg√© !`, 'success');
            }
            
            // Fonction pour afficher des notifications
            function showNotification(message, type = 'info') {
                const $notification = $(`
                    <div class="notification ${type}" style="
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: ${type === 'success' ? 'linear-gradient(145deg, #48bb78, #38a169)' : 'linear-gradient(145deg, #4299e1, #3182ce)'};
                        color: white;
                        padding: 16px 24px;
                        border-radius: 12px;
                        box-shadow: 0 8px 25px rgba(0,0,0,0.2);
                        z-index: 9999;
                        font-family: 'Lexend Deca', sans-serif;
                        font-weight: 500;
                        transform: translateX(400px);
                        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                    ">${message}</div>
                `);
                
                $('body').append($notification);
                
                // Animation d'entr√©e
                setTimeout(() => {
                    $notification.css('transform', 'translateX(0)');
                }, 100);
                
                // Suppression automatique
                setTimeout(() => {
                    $notification.css('transform', 'translateX(400px)');
                    setTimeout(() => $notification.remove(), 400);
                }, 3000);
            }

            // Algorithme g√©n√©tique pour optimisation
            class GeneticOptimizer {
                constructor(targetTemp, minComp, maxComp, materials) {
                    this.targetTemp = targetTemp;
                    this.minComponents = minComp;
                    this.maxComponents = maxComp;
                    this.materials = materials;
                    this.populationSize = 50;
                    this.generations = 100;
                    this.mutationRate = 0.1;
                    this.crossoverRate = 0.8;
                    this.eliteSize = 5;
                }

                // Cr√©er un individu al√©atoire
                createRandomIndividual() {
                    const numComponents = Math.floor(Math.random() * (this.maxComponents - this.minComponents + 1)) + this.minComponents;
                    const selectedMaterials = [];
                    const availableIndices = Array.from({length: this.materials.length}, (_, i) => i);
                    
                    // S√©lectionner des mat√©riaux al√©atoirement
                    for (let i = 0; i < numComponents; i++) {
                        const randomIndex = Math.floor(Math.random() * availableIndices.length);
                        selectedMaterials.push(availableIndices.splice(randomIndex, 1)[0]);
                    }
                    
                    return selectedMaterials;
                }

                // √âvaluer la fitness (1/(√©cart de temp√©rature + 1))
                async evaluateFitness(individual) {
                    try {
                        const selectedMaterials = individual.map(index => this.materials[index]);
                        const result = calculateEutectic(selectedMaterials);
                        
                        if (!result.converged) {
                            return 0.001; // P√©nalit√© pour non-convergence
                        }
                        
                        const tempDifference = Math.abs(result.temperature - this.targetTemp);
                        return 1 / (tempDifference + 1);
                    } catch (error) {
                        return 0.001; // P√©nalit√© pour erreur
                    }
                }

                // S√©lection par tournoi
                tournamentSelection(population, fitnesses, tournamentSize = 3) {
                    const tournament = [];
                    for (let i = 0; i < tournamentSize; i++) {
                        const randomIndex = Math.floor(Math.random() * population.length);
                        tournament.push({individual: population[randomIndex], fitness: fitnesses[randomIndex], index: randomIndex});
                    }
                    return tournament.sort((a, b) => b.fitness - a.fitness)[0].individual;
                }

                // Croisement uniforme
                crossover(parent1, parent2) {
                    if (Math.random() > this.crossoverRate) return [parent1.slice(), parent2.slice()];
                    
                    const allMaterials = new Set([...parent1, ...parent2]);
                    const materialsArray = Array.from(allMaterials);
                    
                    const child1Size = Math.min(Math.max(Math.floor(Math.random() * (this.maxComponents - this.minComponents + 1)) + this.minComponents, this.minComponents), materialsArray.length);
                    const child2Size = Math.min(Math.max(Math.floor(Math.random() * (this.maxComponents - this.minComponents + 1)) + this.minComponents, this.minComponents), materialsArray.length);
                    
                    const shuffled1 = materialsArray.sort(() => 0.5 - Math.random());
                    const shuffled2 = materialsArray.sort(() => 0.5 - Math.random());
                    
                    return [shuffled1.slice(0, child1Size), shuffled2.slice(0, child2Size)];
                }

                // Mutation
                mutate(individual) {
                    const mutated = individual.slice();
                    
                    if (Math.random() < this.mutationRate) {
                        // Remplacer un mat√©riau par un autre
                        const randomIndex = Math.floor(Math.random() * mutated.length);
                        let newMaterial;
                        do {
                            newMaterial = Math.floor(Math.random() * this.materials.length);
                        } while (mutated.includes(newMaterial));
                        mutated[randomIndex] = newMaterial;
                    }
                    
                    if (Math.random() < this.mutationRate / 2) {
                        // Ajouter ou retirer un mat√©riau
                        if (mutated.length < this.maxComponents && Math.random() < 0.5) {
                            // Ajouter
                            let newMaterial;
                            do {
                                newMaterial = Math.floor(Math.random() * this.materials.length);
                            } while (mutated.includes(newMaterial));
                            mutated.push(newMaterial);
                        } else if (mutated.length > this.minComponents) {
                            // Retirer
                            const randomIndex = Math.floor(Math.random() * mutated.length);
                            mutated.splice(randomIndex, 1);
                        }
                    }
                    
                    return mutated;
                }

                // Optimisation principale
                async optimize(progressCallback) {
                    // Population initiale
                    let population = [];
                    for (let i = 0; i < this.populationSize; i++) {
                        population.push(this.createRandomIndividual());
                    }

                    let bestSolutions = [];

                    for (let generation = 0; generation < this.generations; generation++) {
                        // √âvaluation de la population
                        const fitnesses = [];
                        for (const individual of population) {
                            const fitness = await this.evaluateFitness(individual);
                            fitnesses.push(fitness);
                        }

                        // Trier par fitness
                        const sorted = population.map((ind, i) => ({individual: ind, fitness: fitnesses[i]}))
                                                .sort((a, b) => b.fitness - a.fitness);

                        // Sauvegarder les meilleures solutions
                        if (generation % 10 === 0 || generation === this.generations - 1) {
                            for (let i = 0; i < Math.min(3, sorted.length); i++) {
                                const solution = {
                                    materials: sorted[i].individual.map(idx => this.materials[idx]),
                                    fitness: sorted[i].fitness,
                                    generation: generation
                                };
                                bestSolutions.push(solution);
                            }
                        }

                        // Progr√®s
                        if (progressCallback) {
                            progressCallback({
                                generation: generation + 1,
                                total: this.generations,
                                bestFitness: sorted[0].fitness,
                                temperature: await this.getTemperature(sorted[0].individual)
                            });
                        }

                        // Nouvelle g√©n√©ration
                        const newPopulation = [];
                        
                        // √âlite
                        for (let i = 0; i < this.eliteSize; i++) {
                            newPopulation.push(sorted[i].individual.slice());
                        }

                        // Croisement et mutation
                        while (newPopulation.length < this.populationSize) {
                            const parent1 = this.tournamentSelection(population, fitnesses);
                            const parent2 = this.tournamentSelection(population, fitnesses);
                            const [child1, child2] = this.crossover(parent1, parent2);
                            
                            newPopulation.push(this.mutate(child1));
                            if (newPopulation.length < this.populationSize) {
                                newPopulation.push(this.mutate(child2));
                            }
                        }

                        population = newPopulation;
                    }

                    // Trier les meilleures solutions uniques
                    const uniqueSolutions = [];
                    const seen = new Set();
                    
                    for (const sol of bestSolutions) {
                        const key = sol.materials.map(m => m.name).sort().join('|');
                        if (!seen.has(key)) {
                            seen.add(key);
                            sol.result = calculateEutectic(sol.materials);
                            uniqueSolutions.push(sol);
                        }
                    }

                    return uniqueSolutions.sort((a, b) => b.fitness - a.fitness).slice(0, 5);
                }

                async getTemperature(individual) {
                    try {
                        const selectedMaterials = individual.map(index => this.materials[index]);
                        const result = calculateEutectic(selectedMaterials);
                        return result.temperature;
                    } catch {
                        return null;
                    }
                }
            }

            // Interface utilisateur pour l'algorithme g√©n√©tique
            async function startGeneticOptimization() {
                const targetTemp = parseFloat($('#targetTemp').val());
                const minComp = parseInt($('#minComponents').val());
                const maxComp = parseInt($('#maxComponents').val());
                
                if (isNaN(targetTemp)) {
                    alert('Veuillez entrer une temp√©rature cible valide.');
                    return;
                }
                
                if (minComp > maxComp) {
                    alert('Le nombre minimum de composants doit √™tre inf√©rieur ou √©gal au maximum.');
                    return;
                }

                const $btn = $('#startGeneticBtn');
                const $progress = $('#geneticProgress');
                const $results = $('#geneticResults');
                const $progressBar = $('#progressBar');
                const $progressText = $('#progressText');
                
                // Interface
                $btn.prop('disabled', true).text('üß† Optimisation en cours...');
                $progress.addClass('active');
                $results.removeClass('show').empty();
                
                const optimizer = new GeneticOptimizer(targetTemp, minComp, maxComp, materials);
                
                try {
                    const solutions = await optimizer.optimize((progress) => {
                        const percentage = (progress.generation / progress.total) * 100;
                        $progressBar.css('--progress', percentage + '%');
                        $progressBar[0].style.setProperty('--progress', percentage + '%');
                        $progressText.text(`G√©n√©ration ${progress.generation}/${progress.total} - Meilleure: ${progress.temperature ? progress.temperature.toFixed(1) : '?'}¬∞C`);
                        
                        // Mise √† jour visuelle de la barre
                        $progressBar.find('::before').css('width', percentage + '%');
                    });
                    
                    // Afficher les r√©sultats
                    displayGeneticResults(solutions, targetTemp);
                    
                } catch (error) {
                    console.error('Erreur lors de l\'optimisation:', error);
                    showNotification('‚ùå Erreur lors de l\'optimisation g√©n√©tique', 'error');
                } finally {
                    $btn.prop('disabled', false).text('üß† Recherche optimale');
                    $progress.removeClass('active');
                }
            }
            
            // Afficher les r√©sultats de l'algorithme g√©n√©tique
            function displayGeneticResults(solutions, targetTemp) {
                const $results = $('#geneticResults');
                $results.empty();
                
                if (solutions.length === 0) {
                    $results.html('<p style="text-align: center; color: #666;">Aucune solution trouv√©e. Essayez avec des param√®tres diff√©rents.</p>');
                    $results.addClass('show');
                    return;
                }
                
                const $title = $('<h5>').text(`üéØ Meilleures solutions pour ${targetTemp}¬∞C`)
                    .css({'color': '#4c1d95', 'margin-bottom': '12px', 'text-align': 'center'});
                $results.append($title);
                
                solutions.forEach((solution, index) => {
                    const tempDiff = Math.abs(solution.result.temperature - targetTemp);
                    const $solution = $(`
                        <div class="solution-item" data-solution="${index}">
                            <div class="solution-header">
                                <span class="solution-title">Solution ${index + 1} (${solution.materials.length} composants)</span>
                                <span class="solution-temp">${solution.result.temperature.toFixed(1)}¬∞C (¬±${tempDiff.toFixed(1)})</span>
                            </div>
                            <div class="solution-components">
                                ${solution.materials.map(m => m.name).join(' + ')}
                            </div>
                        </div>
                    `);
                    
                    // Clic pour charger la solution
                    $solution.on('click', () => loadGeneticSolution(solution));
                    
                    $results.append($solution);
                });
                
                $results.addClass('show');
            }
            
            // Charger une solution g√©n√©tique
            function loadGeneticSolution(solution) {
                // R√©initialiser
                resetApplication();
                
                // Ajouter les dropdowns
                while (materialDropdowns.length < solution.materials.length) {
                    addMaterialDropdown();
                }
                
                // Charger les mat√©riaux
                solution.materials.forEach((material, index) => {
                    const materialIndex = materials.findIndex(m => m.name === material.name);
                    if (materialIndex !== -1) {
                        const dropdownId = materialDropdowns[index];
                        $(`[data-id="${dropdownId}"] .material-select`).val(materialIndex).trigger('change');
                    }
                });
                
                showNotification(`üß† Solution g√©n√©tique charg√©e: ${solution.result.temperature.toFixed(1)}¬∞C`, 'success');
            }

            // Event listeners
            $('#addMaterialBtn').on('click', addMaterialDropdown);
            
            // Gestion des cas de test
            $('#testCase1').on('click', () => loadTestCase('case1'));
            $('#testCase2').on('click', () => loadTestCase('case2'));
            $('#testCase3').on('click', () => loadTestCase('case3'));
            
            // Algorithme g√©n√©tique
            $('#startGeneticBtn').on('click', startGeneticOptimization);
            
            // Mise √† jour de la barre de progr√®s via CSS custom property
            const style = document.createElement('style');
            style.textContent = `
                .progress-bar::before {
                    width: var(--progress, 0%);
                }
            `;
            document.head.appendChild(style);
            
            $('#resetBtn').on('click', function() {
                if (confirm('Voulez-vous vraiment r√©initialiser tous les param√®tres ?')) {
                    resetApplication();
                }
            });

            $('#calculateBtn').on('click', function() {
                const selectedMaterials = getSelectedMaterials();
                
                if (selectedMaterials.length < 2) {
                    alert('Veuillez s√©lectionner au moins 2 mat√©riaux.');
                    return;
                }
                
                // V√©rifier les doublons
                const names = selectedMaterials.map(m => m.name);
                const uniqueNames = [...new Set(names)];
                if (names.length !== uniqueNames.length) {
                    alert('Vous ne pouvez pas s√©lectionner le m√™me mat√©riau plusieurs fois.');
                    return;
                }
                
                // Afficher le chargement
                $('#loading').show();
                $('#results').removeClass('show');
                
                // Simuler un d√©lai de calcul
                setTimeout(() => {
                    try {
                        const result = calculateEutectic(selectedMaterials);
                        displayResults(result);
                        updateCompositionDiagram(result);
                    } catch (error) {
                        $('#results').html(`
                            <div style="color: #dc3545;">
                                <h4>‚ùå Erreur de calcul</h4>
                                <p>Une erreur est survenue lors du calcul: ${error.message}</p>
                                <p>V√©rifiez que les mat√©riaux s√©lectionn√©s sont compatibles.</p>
                            </div>
                        `);
                        $('#results').addClass('show');
                    }
                    
                    $('#loading').hide();
                }, 1000);
            });

            // Tooltip
            $(document).on('mouseenter', '.eutectic-point', function(e) {
                const $tooltip = $('#tooltip');
                const text = $(this).attr('title');
                
                $tooltip.text(text).css({
                    left: e.pageX + 10,
                    top: e.pageY - 30,
                    opacity: 1
                });
            });

            $(document).on('mouseleave', '.eutectic-point', function() {
                $('#tooltip').css('opacity', 0);
            });

            $(document).on('mousemove', '.eutectic-point', function(e) {
                $('#tooltip').css({
                    left: e.pageX + 10,
                    top: e.pageY - 30
                });
            });

            // Initialisation
            initializeDropdowns();
        });
    </script>
</body>
</html>